{% extends "base.html" %}
{% block content %}
<div class="row g-3">
  <div class="col-md-3">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">System Status</h6>
        <div class="d-flex align-items-center mb-2">
          <span class="status-indicator status-online" id="sys-status-indicator"></span>
          <span class="small">Healthy:</span> <span id="sys-healthy" class="ms-auto">-</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Strategies:</span> <span id="sys-strategies">0</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Positions:</span> <span id="sys-positions">0</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Signals:</span> <span id="sys-signals">0</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Uptime:</span> <span id="sys-uptime" class="small">-</span>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">P&L Summary</h6>
        <div class="d-flex justify-content-between mb-2">
          <span class="small">Realized:</span>
          <span id="pnl-realized" class="fw-bold">₹0.00</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span class="small">Unrealized:</span>
          <span id="pnl-unrealized" class="fw-bold">₹0.00</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Total:</span>
          <span id="pnl-total" class="fw-bold">₹0.00</span>
        </div>
        <div class="progress mt-2" style="height: 4px;">
          <div id="pnl-progress" class="progress-bar" role="progressbar" style="width: 0%"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">Risk Metrics</h6>
        <div class="d-flex justify-content-between mb-2">
          <span class="small">Risk Level:</span>
          <span id="risk-level" class="badge bg-secondary">-</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span class="small">Max Drawdown:</span>
          <span id="max-drawdown" class="fw-bold">0.00%</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Sharpe Ratio:</span>
          <span id="sharpe-ratio" class="fw-bold">0.00</span>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">Market Overview</h6>
        <div class="d-flex justify-content-between mb-2">
          <span class="small">Active Symbols:</span>
          <span id="active-symbols">0</span>
        </div>
        <div class="d-flex justify-content-between mb-2">
          <span class="small">Signal Rate:</span>
          <span id="signal-rate" class="small">0/min</span>
        </div>
        <div class="d-flex justify-content-between">
          <span class="small">Last Update:</span>
          <span id="last-update" class="small">-</span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mt-1">
  <div class="col-md-8">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h6 class="card-title mb-0">P&L Chart</h6>
          <div class="btn-group btn-group-sm" role="group">
            <button type="button" class="btn btn-outline-primary active" onclick="setChartPeriod('1h')">1H</button>
            <button type="button" class="btn btn-outline-primary" onclick="setChartPeriod('6h')">6H</button>
            <button type="button" class="btn btn-outline-primary" onclick="setChartPeriod('24h')">24H</button>
            <button type="button" class="btn btn-outline-primary" onclick="setChartPeriod('7d')">7D</button>
          </div>
        </div>
        <canvas id="pnlChart" height="100"></canvas>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">Recent Signals</h6>
        <div id="signalsList" class="list-group list-group-flush" style="max-height: 300px; overflow-y: auto;"></div>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mt-1">
  <div class="col-md-8">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">Positions</h6>
        <div class="table-responsive">
          <table class="table table-dark table-sm align-middle">
            <thead>
              <tr>
                <th>Symbol</th>
                <th class="text-end">Quantity</th>
                <th class="text-end">Avg Price</th>
                <th class="text-end">LTP</th>
                <th class="text-end">P&L</th>
                <th class="text-end">P&L %</th>
              </tr>
            </thead>
            <tbody id="positionsBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card bg-secondary text-light">
      <div class="card-body">
        <h6 class="card-title">Quick Actions</h6>
        <div class="d-grid gap-2">
          <button class="btn btn-primary btn-sm" onclick="location.href='/symbols'">
            <i class="bi bi-graph-up"></i> Symbol Management
          </button>
          <button class="btn btn-warning btn-sm" onclick="location.href='/risk'">
            <i class="bi bi-shield-exclamation"></i> Risk Dashboard
          </button>
          <button class="btn btn-info btn-sm" onclick="location.href='/timeframes'">
            <i class="bi bi-clock"></i> Timeframe Analysis
          </button>
          <button class="btn btn-success btn-sm" onclick="exportData()">
            <i class="bi bi-download"></i> Export Data
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
